<!DOCTYPE html>
<html layout:decorator="layout/baselayout"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.thymeleaf.org">
<head>
    <th:block layout:fragment="styles">
        <style>
            .add-page {
                text-align: center;
                margin-top: 30px;
            }
        </style>
    </th:block>
</head>
<body>
<div layout:fragment="content">
    <div class="row">
        <div class="col-md-6">
            <h3>Settings</h3>
            <form th:action="@{/sites/{id}/(id=${site.id})}" method="post">
                <div class="form-group">
                    <label for="name">Site name</label>
                    <input type="text" class="form-control" name="name" id="name" placeholder="Site name" th:value="${site.name}"/>
                </div>
                <div class="form-group">
                    <label>Design theme</label>
                    <br/>
                    <label class="radio-inline"><input type="radio" name="optradio" checked="true"/>Light</label>
                    <label class="radio-inline"><input type="radio" name="optradio"/>Dark</label>
                </div>
                <div class="form-group">
                    <label>Navigation menu</label>
                    <br/>
                    <label class="checkbox-inline"><input type="checkbox" value=""/>Horizontal</label>
                    <label class="checkbox-inline"><input type="checkbox" value=""/>Vertical</label>
                </div>
                <button type="submit" class="btn btn-default">Save</button>
            </form>
        </div>
        <div class="col-md-6">
            <h3>Pages</h3>
            <div class="panel panel-warning" th:if="${#lists.isEmpty(site.pages)}">
                <div class="panel-heading">
                    <h3 class="panel-title">No pages</h3>
                </div>
                <div class="panel-body">
                    You haven't got any pages. Create page and fill them with content.
                </div>
            </div>
            <div class="add-page">
                <button type="button" class="btn btn-default" onclick="create()">Add page</button>
            </div>
            <ul>
                <li th:each="page : ${site.pages}">
                    <a th:href="@{/pages/{id}(id=${page.id})}" th:text="${page.name}"></a>
                    <button type="button" class="btn btn-default btn-xs" th:onclick="'removePage(' + ${page.id} + ');'">Delete</button>
                </li>
            </ul>
        </div>
    </div>

</div>
<th:block layout:fragment="scripts">
    <script th:inline="javascript">
        //        <![CDATA[

        $(document).ready(function () {


        });


        function create() {
            $.post('/pages/create', {
                site: [[${site.id}]],
                [[${_csrf.parameterName}]]: [[${_csrf.token}]]
            }, function (response, status) {
                window.location.href = '/pages/' + response;
            });
        }

        function removePage(id) {
            $.ajax({
                url: '/pages/' + id + '?' + [[${_csrf.parameterName}]] + '=' + [[${_csrf.token}]],
                type: 'DELETE',
                success: function(result) {
                    window.location.href = '/sites/[[${site.id}]]';
                }
            });
        }

        //        ]]>
    </script>
</th:block>
</body>
</html>